{% extends "base.html" %}

{% block title %}Detalhes do Precat√≥rio{% endblock %}

{% block content %}
<div class="dashboard-layout">
  {% include 'partials/sidebar.html' %}

  <section class="dashboard-content py-6 px-4 grid grid-cols-1 md:grid-cols-3 gap-6">
    <!-- Coluna 1 - Info do Usu√°rio estilo card -->
    <div class="bg-white shadow rounded-2xl p-5 border">
      <h4 class="font-semibold mb-4">Informa√ß√µes do Usu√°rio</h4>
      <ul class="text-sm text-gray-700 space-y-3">
        <li class="flex items-center gap-3">
          <i class="bi bi-telephone text-primary"></i>
          <div>
            <div class="text-gray-500 text-xs">Telefone</div>
            <div>{{ precatorio.telefone }}</div>
          </div>
        </li>
        <li class="flex items-center gap-3">
          <i class="bi bi-envelope text-primary"></i>
          <div>
            <div class="text-gray-500 text-xs">E-mail</div>
            <div>{{ precatorio.email }}</div>
          </div>
        </li>
        <li class="flex items-center gap-3">
          <i class="bi bi-credit-card-2-front text-primary"></i>
          <div>
            <div class="text-gray-500 text-xs">CPF/CNPJ</div>
            <div>{{ precatorio.cpf_cnpj }}</div>
          </div>
        </li>
        <li class="flex items-center gap-3">
          <i class="bi bi-calendar-event text-primary"></i>
          <div>
            <div class="text-gray-500 text-xs">Data de Cadastro</div>
            <div>{{ precatorio.data_cadastro.strftime('%d/%m/%Y') }}</div>
          </div>
        </li>
        <li class="flex items-center gap-3">
          <i class="bi bi-info-circle text-primary"></i>
          <div>
            <div class="text-gray-500 text-xs">Tipo de Registro</div>
            <div>{{ precatorio.tipo_entrada|capitalize }}</div>
          </div>
        </li>
        <li class="flex items-center gap-3">
          <i class="bi bi-check-circle text-primary"></i>
          <div>
            <div class="text-gray-500 text-xs">Status</div>
            <div>{{ precatorio.status }}</div>
          </div>
        </li>
      </ul>
    </div>

    <!-- Coluna 2 - Dados do Precat√≥rio -->
    <div class="bg-white shadow rounded-2xl p-4">
      <h4 class="font-semibold mb-3 text-primary">Detalhes do Precat√≥rio</h4>
      <ul class="text-sm text-gray-700">
        <li><strong>N√∫mero:</strong> {{ precatorio.numero or '-' }}</li>
        <li><strong>Tipo:</strong> {{ precatorio.tipo }}</li>
        <li><strong>Valor:</strong> R$ {{ '%.2f' | format(precatorio.valor) }}</li>
        <li><strong>Estado:</strong> {{ precatorio.estado or '-' }}</li>
        <li><strong>Munic√≠pio:</strong> {{ precatorio.municipio or '-' }}</li>
      </ul>
    </div>

    <!-- Coluna 3 - A√ß√µes e Documentos -->
    <div class="bg-white shadow rounded-2xl p-4">
      <h4 class="font-semibold mb-3 text-primary">üìé Documentos</h4>
      {% if precatorio.documentos %}
      <ul class="text-sm divide-y">
        {% for doc in precatorio.documentos %}
        <li class="py-2 flex justify-between items-center">
          <span>
            <i class="bi bi-file-earmark"></i> {{ doc.nome_arquivo }}<br>
            <small class="text-muted">por {{ doc.usuario.nome if doc.usuario else 'An√¥nimo' }}</small>
          </span>
          <a href="{{ url_for('main.download_documento', id=doc.id) }}" class="btn btn-sm btn-outline-primary">Baixar</a>
        </li>
        {% endfor %}
      </ul>
      {% else %}
      <p class="text-muted text-sm">Nenhum documento enviado ainda.</p>
      {% endif %}

      <form method="POST" action="{{ url_for('main.upload_documento', id=precatorio.id) }}" enctype="multipart/form-data" class="mt-4">
        <label class="block mb-2 text-sm font-medium">Enviar novo documento</label>
        <input type="file" name="documentos" accept=".pdf,.png,.jpg,.jpeg" multiple required class="form-control mb-2">
        <button type="submit" class="btn btn-primary">Enviar</button>
      </form>
    </div>
  </section>

  <div class="px-4 py-6">
    <a href="{{ request.referrer or url_for('main.dashboard') }}" class="btn btn-outline-secondary">Voltar</a>
  </div>
</div>
{% endblock %}
